withinpressure <- wpdx_nigeria_clean %>%
filter(`pressure_score` <= 1.183)
rural <- wpdx_nigeria_clean %>%
filter(`is_urban` == 'FALSE')
urban <- wpdx_nigeria_clean %>%
filter(`is_urban` == 'TRUE')
nigeria$wpt_lowcap <- lengths(st_intersects(nigeria, lowcap))
nigeria$wpt_lowcap <- lengths(st_intersects(nigeria, lowcap))
View(lowcap)
nigeria$wpt_rural<- lengths(st_intersects(nigeria, rural))
Spring <- wpdx_nigeria_sf %>%
filter(`Water_Source` == 'Spring')
Well <- wpdx_nigeria_sf %>%
filter(`Water_Source` == 'Well')
nigeria$source_Spring <- lengths(st_intersects(nigeria, Spring))
nigeria$source_Well <-lengths(st_intersects(nigeria, Well))
lowcap <- wpdx_nigeria_sf %>%
filter(`usage_capacity` < 1000)
highcap <- wpdx_nigeria_sf %>%
filter(`usage_capacity` >= 1000)
lowcrucial <- wpdx_nigeria_sf %>%
filter(`crucialness_score` <= 0.30)
withinpressure <- wpdx_nigeria_sf %>%
filter(`pressure_score` <= 1.183)
rural <- wpdx_nigeria_sf %>%
filter(`is_urban` == 'FALSE')
urban <- wpdx_nigeria_sf %>%
filter(`is_urban` == 'TRUE')
nigeria$wpt_lowcap <- lengths(st_intersects(nigeria, lowcap))
nigeria$wpt_highcap <- lengths(st_intersects(nigeria, highcap))
nigeria$wpt_rural<- lengths(st_intersects(nigeria, rural))
nigeria$wpt_urban<- lengths(st_intersects(nigeria, urban))
nigeria$wpt_lowcrucial <- lengths(st_intersects(nigeria, lowcrucial))
nigeria$wpt_withinpressure<- lengths(st_intersects(nigeria, withinpressure))
nigeria$wpt_lowcap <- lengths(st_intersects(nigeria, lowcap))
nigeria$wpt_highcap <- lengths(st_intersects(nigeria, highcap))
nigeria$wpt_rural<- lengths(st_intersects(nigeria, rural))
nigeria$wpt_urban<- lengths(st_intersects(nigeria, urban))
nigeria$wpt_lowcrucial <- lengths(st_intersects(nigeria, lowcrucial))
nigeria$wpt_withinpressure<- lengths(st_intersects(nigeria, withinpressure))
View(nigeria)
nigeria_gcs <- nigeria
nigeria <- st_transform(nigeria, crs = 26391)
st_geometry(nigeria)
lowcap <- wpdx_nigeria_sf %>%
filter(`usage_capacity` < 1000)
highcap <- wpdx_nigeria_sf %>%
filter(`usage_capacity` >= 1000)
lowcrucial <- wpdx_nigeria_sf %>%
filter(`crucialness_score` <= 0.30)
highcrucial <- wpdx_nigeria_sf %>%
filter(`crucialness_score` > 0.30)
withinpressure <- wpdx_nigeria_sf %>%
filter(`pressure_score` <= 1.183)
highpressure <- wpdx_nigeria_sf %>%
filter(`pressure_score` > 1.183)
rural <- wpdx_nigeria_sf %>%
filter(`is_urban` == 'FALSE')
urban <- wpdx_nigeria_sf %>%
filter(`is_urban` == 'TRUE')
nigeria$wpt_lowcap <- lengths(st_intersects(nigeria, lowcap))
View(nigeria)
View(nigeria)
wpdx <- read_csv("data\\aspatial\\WPdx_NGAv1.2.1.csv", show_col_types = FALSE)
nigeria <- st_read(dsn = "data\\geospatial",
layer = "geoBoundaries-NGA-ADM2")
nigeria <- nigeria %>%
rename(`LGA` = `shapeName`)
nigeria$LGA[94] <- "Bassa_Kogi"
nigeria$LGA[95] <- "Bassa_Plateau"
nigeria$LGA[304] <- "Ifelodun, Kwara"
nigeria$LGA[305] <- "Ifelodun, Osun"
nigeria$LGA[355] <- "Irepodun, Kwara"
nigeria$LGA[356] <- "Irepodun, Osun"
nigeria$LGA[519] <- "Nassarawa, Kano"
nigeria$LGA[546] <- "Obi, Benue"
nigeria$LGA[547] <- "Obi, Nasarawa"
nigeria$LGA[693] <- "Surulere, Lagos"
nigeria$LGA[694] <- "Surulere, Oyo"
nigeria$LGA[duplicated(nigeria$LGA)==TRUE]
count(wpdx, `#status_clean`)
wpdx_nigeria_clean <- wpdx %>%
mutate(`#status_clean` = recode(`#status_clean`, "Non functional due to dry season" = "Non-Functional due to dry season")) %>%
mutate(`#status_clean` = replace_na(`#status_clean`, "Unknown")) %>%
mutate(`#water_tech_category` = replace_na(`#water_tech_category`, "Unknown")) %>%
mutate(`#water_source_category` = replace_na(`#water_source_category`, "Unknown")) %>%
mutate(`#water_source_category` = replace_na(`#water_source_category`, "Unknown"))
wpdx_nigeria_clean <- wpdx_nigeria_clean %>%
mutate(`Water_Source` = `#water_source_category`) %>%
mutate(`Water_Tech` = `#water_tech_category`) %>%
mutate(`Functional_Status` = `#status_clean`) %>%
mutate(`Functional_Status` = recode(`Functional_Status`,
"Abandoned" = "Non-Functional",
"Abandoned/Decommissioned" = "Non-Functional",
"Functional but needs repair" = "Functional",
"Functional but not in use" = "Functional",
"Non-Functional due to dry season" = "Non-Functional"))
count(wpdx_nigeria_clean, `Functional_Status`)
count(wpdx_nigeria_clean, `#water_source_category`)
wpdx_nigeria_clean <- wpdx_nigeria_clean %>%
rename(`LGA` = `#clean_adm2`)
wpdx_nigeria_sf <- st_as_sf(wpdx_nigeria_clean,
coords = c("#lon_deg","#lat_deg"),
crs=4326)
st_geometry(wpdx_nigeria_sf)
functional <- wpdx_nigeria_sf %>%
filter(`Functional_Status` == 'Functional')
non_functional <- wpdx_nigeria_sf %>%
filter(`Functional_Status` == 'Non-Functional')
unknown <- wpdx_nigeria_sf %>%
filter(`Functional_Status` == 'Unknown')
nigeria$wpt_functional <- lengths(st_intersects(nigeria, functional))
nigeria$wpt_nonfunctional <- lengths(st_intersects(nigeria, non_functional))
nigeria$wpt_unknown <-lengths(st_intersects(nigeria, unknown))
nigeria$wpt_total <- lengths(st_intersects(nigeria, functional)) +
lengths(st_intersects(nigeria, non_functional)) +
lengths(st_intersects(nigeria, unknown))
HandPump	 <- wpdx_nigeria_sf %>%
filter(`Water_Tech` == 'Hand Pump')
MechanizedPump <- wpdx_nigeria_sf %>%
filter(`Water_Tech` == 'Mechanized Pump')
nigeria$tech_HandPump <- lengths(st_intersects(nigeria, HandPump))
nigeria$tech_MechanizedPump <- lengths(st_intersects(nigeria, MechanizedPump))
Spring <- wpdx_nigeria_sf %>%
filter(`Water_Source` == 'Spring')
Well <- wpdx_nigeria_sf %>%
filter(`Water_Source` == 'Well')
nigeria$source_Spring <- lengths(st_intersects(nigeria, Spring))
nigeria$source_Well <-lengths(st_intersects(nigeria, Well))
nigeria <- nigeria %>%
mutate(pct_functional = `wpt_functional`/ `wpt_total`) %>%
mutate(`pct_functional` = replace_na(`pct_functional`, 0)) %>%
mutate(pct_nonfunctional = `wpt_nonfunctional`/ `wpt_total`) %>%
mutate(`pct_nonfunctional` = replace_na(`pct_nonfunctional`, 0))
lowcap <- wpdx_nigeria_sf %>%
filter(`usage_capacity` < 1000)
highcap <- wpdx_nigeria_sf %>%
filter(`usage_capacity` >= 1000)
lowcrucial <- wpdx_nigeria_sf %>%
filter(`crucialness_score` <= 0.30)
highcrucial <- wpdx_nigeria_sf %>%
filter(`crucialness_score` > 0.30)
withinpressure <- wpdx_nigeria_sf %>%
filter(`pressure_score` <= 1.183)
highpressure <- wpdx_nigeria_sf %>%
filter(`pressure_score` > 1.183)
rural <- wpdx_nigeria_sf %>%
filter(`is_urban` == 'FALSE')
urban <- wpdx_nigeria_sf %>%
filter(`is_urban` == 'TRUE')
nigeria$wpt_lowcap <- lengths(st_intersects(nigeria, lowcap))
nigeria$wpt_highcap <- lengths(st_intersects(nigeria, highcap))
nigeria$wpt_rural<- lengths(st_intersects(nigeria, rural))
nigeria$wpt_urban<- lengths(st_intersects(nigeria, urban))
nigeria$wpt_lowcrucial <- lengths(st_intersects(nigeria, lowcrucial))
nigeria$wpt_highcrucial <- lengths(st_intersects(nigeria, highcrucial))
nigeria$wpt_withinpressure <- lengths(st_intersects(nigeria, withinpressure))
nigeria$wpt_highpressure <- lengths(st_intersects(nigeria, highpressure))
nigeria_gcs <- nigeria
nigeria <- st_transform(nigeria, crs = 26391)
st_geometry(nigeria)
View(nigeria)
nigeria <- nigeria %>%
mutate(`pct_spring` = `source_Spring`/`wpt_total`) %>%
mutate(`pct_spring` = replace_na(`pct_spring`, 0)) %>%
mutate(`pct_well` = `source_Well`/`wpt_total`) %>%
mutate(`pct_well` = replace_na(`pct_well`, 0)) %>%
mutate(`pct_handpump` = `tech_HandPump`/`wpt_total`) %>%
mutate(`pct_handpump` = replace_na(`pct_handpump`, 0)) %>%
mutate(`pct_mechpump` = `tech_MechanizedPump`/`wpt_total`) %>%
mutate(`pct_mechpump` = replace_na(`pct_mechpump`, 0)) %>%
mutate(`pct_lowcap` = `wpt_lowcap`/`wpt_total`) %>%
mutate(`pct_lowcap` = replace_na(`pct_lowcap`, 0)) %>%
mutate(`pct_highcap` = `wpt_highcap`/`wpt_total`) %>%
mutate(`pct_highcap` = replace_na(`pct_highcap`, 0)) %>%
mutate(`pct_rural` = `wpt_rural`/`wpt_total`) %>%
mutate(`pct_rural` = replace_na(`pct_rural`, 0)) %>%
mutate(`pct_urban` = `wpt_urban`/`wpt_total`) %>%
mutate(`pct_urban` = replace_na(`pct_urban`, 0)) %>%
mutate(`pct_lowcrucial` = `wpt_lowcrucial`/`wpt_total`) %>%
mutate(`pct_lowcrucial` = replace_na(`pct_lowcrucial`, 0)) %>%
mutate(`pct_highcrucial` = `wpt_highcrucial`/`wpt_total`) %>%
mutate(`pct_highcrucial` = replace_na(`pct_highcrucial`, 0)) %>%
mutate(`pct_withinpressure` = `wpt_withinpressure`/`wpt_total`) %>%
mutate(`pct_withinpressure` = replace_na(`pct_withinpressure`, 0))
mutate(`pct_highpressure` = `wpt_highpressure`/`wpt_total`) %>%
mutate(`pct_highpressure` = replace_na(`pct_highpressure`, 0))
nigeria <- nigeria %>%
mutate(`pct_spring` = `source_Spring`/`wpt_total`) %>%
mutate(`pct_spring` = replace_na(`pct_spring`, 0)) %>%
mutate(`pct_well` = `source_Well`/`wpt_total`) %>%
mutate(`pct_well` = replace_na(`pct_well`, 0)) %>%
mutate(`pct_handpump` = `tech_HandPump`/`wpt_total`) %>%
mutate(`pct_handpump` = replace_na(`pct_handpump`, 0)) %>%
mutate(`pct_mechpump` = `tech_MechanizedPump`/`wpt_total`) %>%
mutate(`pct_mechpump` = replace_na(`pct_mechpump`, 0)) %>%
mutate(`pct_lowcap` = `wpt_lowcap`/`wpt_total`) %>%
mutate(`pct_lowcap` = replace_na(`pct_lowcap`, 0)) %>%
mutate(`pct_highcap` = `wpt_highcap`/`wpt_total`) %>%
mutate(`pct_highcap` = replace_na(`pct_highcap`, 0)) %>%
mutate(`pct_rural` = `wpt_rural`/`wpt_total`) %>%
mutate(`pct_rural` = replace_na(`pct_rural`, 0)) %>%
mutate(`pct_urban` = `wpt_urban`/`wpt_total`) %>%
mutate(`pct_urban` = replace_na(`pct_urban`, 0)) %>%
mutate(`pct_lowcrucial` = `wpt_lowcrucial`/`wpt_total`) %>%
mutate(`pct_lowcrucial` = replace_na(`pct_lowcrucial`, 0)) %>%
mutate(`pct_highcrucial` = `wpt_highcrucial`/`wpt_total`) %>%
mutate(`pct_highcrucial` = replace_na(`pct_highcrucial`, 0)) %>%
mutate(`pct_withinpressure` = `wpt_withinpressure`/`wpt_total`) %>%
mutate(`pct_withinpressure` = replace_na(`pct_withinpressure`, 0))
mutate(`pct_highpressure` = `wpt_highpressure`/`wpt_total`) %>%
mutate(`pct_highpressure` = replace_na(`pct_highpressure`, 0))
nigeria$wpt_lowcap <- lengths(st_intersects(nigeria, lowcap))
wpdx <- read_csv("data\\aspatial\\WPdx_NGAv1.2.1.csv", show_col_types = FALSE)
nigeria <- st_read(dsn = "data\\geospatial",
layer = "geoBoundaries-NGA-ADM2")
nigeria <- nigeria %>%
rename(`LGA` = `shapeName`)
nigeria$LGA[94] <- "Bassa_Kogi"
nigeria$LGA[95] <- "Bassa_Plateau"
nigeria$LGA[304] <- "Ifelodun, Kwara"
nigeria$LGA[305] <- "Ifelodun, Osun"
nigeria$LGA[355] <- "Irepodun, Kwara"
nigeria$LGA[356] <- "Irepodun, Osun"
nigeria$LGA[519] <- "Nassarawa, Kano"
nigeria$LGA[546] <- "Obi, Benue"
nigeria$LGA[547] <- "Obi, Nasarawa"
nigeria$LGA[693] <- "Surulere, Lagos"
nigeria$LGA[694] <- "Surulere, Oyo"
nigeria$LGA[duplicated(nigeria$LGA)==TRUE]
count(wpdx, `#status_clean`)
wpdx_nigeria_clean <- wpdx %>%
mutate(`#status_clean` = recode(`#status_clean`, "Non functional due to dry season" = "Non-Functional due to dry season")) %>%
mutate(`#status_clean` = replace_na(`#status_clean`, "Unknown")) %>%
mutate(`#water_tech_category` = replace_na(`#water_tech_category`, "Unknown")) %>%
mutate(`#water_source_category` = replace_na(`#water_source_category`, "Unknown")) %>%
mutate(`#water_source_category` = replace_na(`#water_source_category`, "Unknown"))
wpdx_nigeria_clean <- wpdx_nigeria_clean %>%
mutate(`Water_Source` = `#water_source_category`) %>%
mutate(`Water_Tech` = `#water_tech_category`) %>%
mutate(`Functional_Status` = `#status_clean`) %>%
mutate(`Functional_Status` = recode(`Functional_Status`,
"Abandoned" = "Non-Functional",
"Abandoned/Decommissioned" = "Non-Functional",
"Functional but needs repair" = "Functional",
"Functional but not in use" = "Functional",
"Non-Functional due to dry season" = "Non-Functional"))
count(wpdx_nigeria_clean, `Functional_Status`)
wpdx_nigeria_clean <- wpdx_nigeria_clean %>%
rename(`LGA` = `#clean_adm2`)
wpdx_nigeria_sf <- st_as_sf(wpdx_nigeria_clean,
coords = c("#lon_deg","#lat_deg"),
crs=4326)
st_geometry(wpdx_nigeria_sf)
functional <- wpdx_nigeria_sf %>%
filter(`Functional_Status` == 'Functional')
non_functional <- wpdx_nigeria_sf %>%
filter(`Functional_Status` == 'Non-Functional')
unknown <- wpdx_nigeria_sf %>%
filter(`Functional_Status` == 'Unknown')
nigeria$wpt_functional <- lengths(st_intersects(nigeria, functional))
nigeria$wpt_nonfunctional <- lengths(st_intersects(nigeria, non_functional))
nigeria$wpt_unknown <-lengths(st_intersects(nigeria, unknown))
nigeria$wpt_total <- lengths(st_intersects(nigeria, functional)) +
lengths(st_intersects(nigeria, non_functional)) +
lengths(st_intersects(nigeria, unknown))
HandPump	 <- wpdx_nigeria_sf %>%
filter(`Water_Tech` == 'Hand Pump')
MechanizedPump <- wpdx_nigeria_sf %>%
filter(`Water_Tech` == 'Mechanized Pump')
nigeria$tech_HandPump <- lengths(st_intersects(nigeria, HandPump))
nigeria$tech_MechanizedPump <- lengths(st_intersects(nigeria, MechanizedPump))
Spring <- wpdx_nigeria_sf %>%
filter(`Water_Source` == 'Spring')
Well <- wpdx_nigeria_sf %>%
filter(`Water_Source` == 'Well')
nigeria$source_Spring <- lengths(st_intersects(nigeria, Spring))
nigeria$source_Well <-lengths(st_intersects(nigeria, Well))
nigeria <- nigeria %>%
mutate(pct_functional = `wpt_functional`/ `wpt_total`) %>%
mutate(`pct_functional` = replace_na(`pct_functional`, 0)) %>%
mutate(pct_nonfunctional = `wpt_nonfunctional`/ `wpt_total`) %>%
mutate(`pct_nonfunctional` = replace_na(`pct_nonfunctional`, 0))
nigeria <- nigeria %>%
mutate(pct_functional = `wpt_functional`/ `wpt_total`) %>%
mutate(`pct_functional` = replace_na(`pct_functional`, 0)) %>%
mutate(pct_nonfunctional = `wpt_nonfunctional`/ `wpt_total`) %>%
mutate(`pct_nonfunctional` = replace_na(`pct_nonfunctional`, 0))
lowcap <- wpdx_nigeria_sf %>%
filter(`usage_capacity` < 1000)
highcap <- wpdx_nigeria_sf %>%
filter(`usage_capacity` >= 1000)
lowcrucial <- wpdx_nigeria_sf %>%
filter(`crucialness_score` <= 0.30)
highcrucial <- wpdx_nigeria_sf %>%
filter(`crucialness_score` > 0.30)
withinpressure <- wpdx_nigeria_sf %>%
filter(`pressure_score` <= 1.183)
highpressure <- wpdx_nigeria_sf %>%
filter(`pressure_score` > 1.183)
rural <- wpdx_nigeria_sf %>%
filter(`is_urban` == 'FALSE')
urban <- wpdx_nigeria_sf %>%
filter(`is_urban` == 'TRUE')
nigeria$wpt_lowcap <- lengths(st_intersects(nigeria, lowcap))
nigeria$wpt_highcap <- lengths(st_intersects(nigeria, highcap))
nigeria$wpt_rural<- lengths(st_intersects(nigeria, rural))
nigeria$wpt_urban<- lengths(st_intersects(nigeria, urban))
nigeria$wpt_lowcrucial <- lengths(st_intersects(nigeria, lowcrucial))
nigeria$wpt_highcrucial <- lengths(st_intersects(nigeria, highcrucial))
nigeria$wpt_withinpressure <- lengths(st_intersects(nigeria, withinpressure))
nigeria$wpt_highpressure <- lengths(st_intersects(nigeria, highpressure))
nigeria <- nigeria %>%
mutate(`pct_spring` = `source_Spring`/`wpt_total`) %>%
mutate(`pct_spring` = replace_na(`pct_spring`, 0)) %>%
mutate(`pct_well` = `source_Well`/`wpt_total`) %>%
mutate(`pct_well` = replace_na(`pct_well`, 0)) %>%
mutate(`pct_handpump` = `tech_HandPump`/`wpt_total`) %>%
mutate(`pct_handpump` = replace_na(`pct_handpump`, 0)) %>%
mutate(`pct_mechpump` = `tech_MechanizedPump`/`wpt_total`) %>%
mutate(`pct_mechpump` = replace_na(`pct_mechpump`, 0)) %>%
mutate(`pct_lowcap` = `wpt_lowcap`/`wpt_total`) %>%
mutate(`pct_lowcap` = replace_na(`pct_lowcap`, 0)) %>%
mutate(`pct_highcap` = `wpt_highcap`/`wpt_total`) %>%
mutate(`pct_highcap` = replace_na(`pct_highcap`, 0)) %>%
mutate(`pct_rural` = `wpt_rural`/`wpt_total`) %>%
mutate(`pct_rural` = replace_na(`pct_rural`, 0)) %>%
mutate(`pct_urban` = `wpt_urban`/`wpt_total`) %>%
mutate(`pct_urban` = replace_na(`pct_urban`, 0)) %>%
mutate(`pct_lowcrucial` = `wpt_lowcrucial`/`wpt_total`) %>%
mutate(`pct_lowcrucial` = replace_na(`pct_lowcrucial`, 0)) %>%
mutate(`pct_highcrucial` = `wpt_highcrucial`/`wpt_total`) %>%
mutate(`pct_highcrucial` = replace_na(`pct_highcrucial`, 0)) %>%
mutate(`pct_withinpressure` = `wpt_withinpressure`/`wpt_total`) %>%
mutate(`pct_withinpressure` = replace_na(`pct_withinpressure`, 0))
mutate(`pct_highpressure` = `wpt_highpressure`/`wpt_total`) %>%
mutate(`pct_highpressure` = replace_na(`pct_highpressure`, 0))
View(nigeria)
nigeria <- nigeria %>%
mutate(`pct_highpressure` = `wpt_highpressure`/`wpt_total`) %>%
mutate(`pct_highpressure` = replace_na(`pct_highpressure`, 0))
nigeria_gcs <- nigeria
nigeria <- st_transform(nigeria, crs = 26391)
st_geometry(nigeria)
write_rds(nigeria, "data\\geodata\\wp_nga.rds")
runApp('tab1')
runApp('tab1')
runApp('tab1')
runApp('tab1')
runApp('prototype-Proportional_symbol_map_interactive')
runApp('tab1')
runApp('tab1')
runApp('tab1')
runApp('tab1')
runApp('tab1')
runApp('tab1')
shiny::runApp('tab1')
wp_nga <- readRDS("C:/rosekyaw/ISSS608-VAA-Project/tab1/data/geodata/wp_nga.rds")
View(wp_nga)
shiny::runApp('tab1')
runApp('tab1')
runApp('tab1')
runApp('tab1')
runApp('tab1')
runApp('tab1')
runApp('tab1')
runApp('tab1')
runApp('tab1')
runApp('tab1')
View(wp_nga)
shiny::runApp('tab1')
runApp('tab1')
runApp('tab1')
shiny::runApp('tab1')
shiny::runApp('tab1')
runApp('tab1')
runApp('tab1')
runApp('tab1')
runApp('tab1')
runApp('tab1')
runApp('tab1')
runApp('tab3')
runApp('tab1')
runApp('tab1')
runApp('tab2')
runApp('tab1')
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
install.packages(c("blob", "cli", "commonmark", "datawizard", "dbplyr", "deSolve", "distributional", "dplyr", "dtplyr", "ggiraph", "googledrive", "googlesheets4", "gtable", "hexbin", "hms", "htmltools", "htmlwidgets", "insight", "lme4", "modelr", "partykit", "pillar", "ps", "rgl", "rlang", "rmarkdown", "see", "sf", "survival", "testthat", "tibble", "vctrs", "wk", "xfun", "XML"))
shiny::runApp()
runApp()
runApp()
devtools::install_github("Roche/ggtips")
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
wp_nga <- readRDS("C:/rosekyaw/ISSS608-VAA-Project/data/wp_nga.rds")
View(wp_nga)
View(wp_nga)
runApp()
nga_clust.sf1$as.matrix.as.factor.cutree..hclust..dist.cluster_vars..method....euclidean.....
nga_clust.sf <- cbind(wp_ngaTrim, as.matrix(groups)) %>%
rename(`cluster`=`as.matrix.groups.`)
pacman::p_load(sf, tmap, shiny, shinythemes, plotly, tidyverse, ggstatsplot, tools)
wp_ngaTrim <- read_rds("data/geodata/wp_ngaTrim.rds")
clusterVarsInput <- wp_ngaTrim %>%
st_set_geometry(NULL) %>%
select("shapeName",
"pct_functional",
"pct_nonFunctional",
"pct_handPump",
"pct_mechPump",
"pct_tapStand",
"pct_uc300",
"pct_uc1000",
"pct_ucN1000",
"pct_uc250",
"pct_urban1",
"pct_urban0",
"pct_cs04",
"pct_cs10",
"pct_stat1",
"pct_stat0",
"pct_ps09",
"pct_ps19")
hclust_ward <- hclust((dist(clusterVarsInput,
method = 'euclidean')),
method = 'ward.D')
groups1 <- as.factor(cutree((hclust((dist(clusterVarsInput,
method = 'euclidean')),
method = 'ward.D')), k = 3))
nga_clust.sf1 <- cbind(wp_ngaTrim, as.matrix(as.factor(cutree((hclust((dist(clusterVarsInput,
method = 'euclidean')),
method = 'ward.D')), k = 3))))
colnames(nga_clust.sf1)[44]
nga_clust.sf1$as.matrix.as.factor.cutree..hclust..dist.cluster_vars..method....euclidean.....
prox_mat_euc <- dist(cluster_vars,
method = 'euclidean')
View(clusterVarsInput)
wp_stdMM <- normalize(cluster_vars)
nga_clust.sf <- cbind(wp_ngaTrim, as.matrix(groups)) %>%
rename(`cluster`=`as.matrix.groups.`)
prox_mat_euc <- dist(clusterVarsInput,
method = 'euclidean')
hclust_ward <- hclust(prox_mat_euc,
method = 'ward.D')
groups <- as.factor(cutree(hclust_ward, k = 3))
nga_clust.sf <- cbind(wp_ngaTrim, as.matrix(groups)) %>%
rename(`cluster`=`as.matrix.groups.`)
tm_shape(nga_clust.sf) +
tm_fill(col = "cluster",
title = "Cluster") +
tm_borders(alpha = 0.3) +
tm_style("cobalt") +
tm_layout(main.title = "Non-Spatial Hierarchical Clustering",
main.title.size = 1.1,
main.title.position = "center",
legend.height = 0.3,
legend.width = 0.1,
legend.title.size = 1,
legend.text.size = 1,
frame = TRUE,
asp = 0)
wp_stdMM <- normalize(clusterVarsInput)
pacman::p_load(sf, tmap, shiny, shinythemes, plotly, tidyverse, ggstatsplot, tools)
wp_stdMM <- normalize(clusterVarsInput)
ngaClustSF <- st_sf((cbind(wp_ngaTrim,
as.matrix
(as.factor
(cutree
(hclust
(dist
(wp_ngaTrim,
method = 'euclidean'),
method = 'ward.D'),
k = 3))))), crs = 26392)
tm_shape(wp_ngaTrim) +
tm_fill("pct_functional",
n = 5,
style = "pretty",
palette = "YlOrRd") +
tm_borders(lwd = 0.1,
alpha = 1) +
tm_view(set.zoom.limits = c(11, 14))
districts <- wp_ngaTrim %>%
filter(shapeName %in% "Aba North")
inputDistrict <-  wp_ngaTrim %>%
filter(shapeName %in% c("Aba North", "Apa"))
tm_shape(wp_ngaTrim) +
tm_polygons() +
tm_shape(inputDistrict) +
tm_fill("pct_functional",
n = 5,
style = "pretty",
palette = "YlOrRd") +
tm_borders(lwd = 0.1,
alpha = 1) +
tm_view(set.zoom.limits = c(11, 14))
